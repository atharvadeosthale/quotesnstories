(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{31:function(e,t,a){e.exports=a(59)},59:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(29),o=a.n(c),l=a(9),s=a(1),m=a(7),u=a.n(m),i=a(11),p=a(13),d=a(15),b=a(8),f=a(14),E=a.n(f),v=function(){var e=Object(n.useState)({email:"",password:""}),t=Object(b.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)({email:"",password:"",role:"admin"}),l=Object(b.a)(o,2),m=l[0],f=l[1],v=Object(n.useState)(!1),g=Object(b.a)(v,2),h=g[0],w=g[1],j=function(e){c(Object(d.a)(Object(d.a)({},a),{},Object(p.a)({},e.target.name,e.target.value)))},O=function(e){f(Object(d.a)(Object(d.a)({},m),{},Object(p.a)({},e.target.name,e.target.value)))};Object(n.useEffect)((function(){localStorage.getItem("token")&&w(!0)}),[]);var N=function(){var e=Object(i.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,E.a.post("/api/login",{email:a.email,password:a.password});case 4:n=e.sent,r=n.data.token,localStorage.setItem("token",r),w(!0),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),alert(e.t0.response.data.msg);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(i.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,E.a.post("/api/register",{email:m.email,password:m.password,role:m.role});case 4:a=e.sent,n=a.data.token,localStorage.setItem("token",n),w(!0),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),alert(e.t0.response.data.msg);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(n.Fragment,null,h&&r.a.createElement(s.a,{to:"/dashboard"}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md"},r.a.createElement("form",{onSubmit:N},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"E-Mail"),r.a.createElement("input",{type:"text",name:"email",placeholder:"E-Mail Address",value:a.email,onChange:function(e){return j(e)},className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",name:"password",placeholder:"Enter your password",value:a.password,onChange:function(e){return j(e)},className:"form-control"})),r.a.createElement("button",{type:"submit",className:"btn btn-success"},"Login"))),r.a.createElement("div",{className:"col-md"},r.a.createElement("form",{onSubmit:k},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"E-Mail"),r.a.createElement("input",{type:"text",name:"email",placeholder:"E-Mail Address",value:m.email,onChange:function(e){return O(e)},className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",name:"password",placeholder:"Enter your password",value:m.password,onChange:function(e){return O(e)},className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"role"},"Role"),r.a.createElement("input",{type:"text",name:"role",placeholder:"admin / user",value:m.role,onChange:function(e){return O(e)},className:"form-control"})),r.a.createElement("button",{type:"submit",className:"btn btn-success"},"Register")))))},g=function(){var e=Object(n.useState)(localStorage.getItem("token")),t=Object(b.a)(e,2),a=t[0],c=(t[1],Object(n.useState)(!1)),o=Object(b.a)(c,2),m=o[0],p=o[1],d=Object(n.useState)(!1),f=Object(b.a)(d,2),v=f[0],g=f[1],h=Object(n.useState)(!1),w=Object(b.a)(h,2),j=w[0],O=w[1],N=function(){var e=Object(i.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={method:"get",url:"/api/auth",headers:{"x-auth-token":a}},e.next=4,E()(t);case 4:n=e.sent,console.log(n.data.permissions),n.data.permissions.forEach(function(){var e=Object(i.a)(u.a.mark((function e(t,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("[index] "+a+" "+t),"AccessRedButton"===t&&p(!0),"AccessGreenButton"===t&&g(!0);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),O(!0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){N()}),[]);return r.a.createElement(n.Fragment,null,j&&r.a.createElement(s.a,{to:"/"}),v&&r.a.createElement(l.b,{className:"btn btn-success"},"Green"),m&&r.a.createElement(l.b,{className:"btn btn-danger"},"Red"),r.a.createElement("br",null),r.a.createElement(l.b,{className:"btn btn-primary",onClick:function(){return localStorage.removeItem("token"),void O(!0)}},"Logout"))};var h=function(){return r.a.createElement(n.Fragment,null,r.a.createElement(l.a,null,r.a.createElement("div",{className:"container"},r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/",component:v}),r.a.createElement(s.b,{exact:!0,path:"/dashboard",component:g})))))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(h,null)),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.2a83175a.chunk.js.map